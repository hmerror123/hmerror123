[
  {
    "Id": "853144",
    "ThreadId": "360789",
    "Html": "\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>Set<span style=\"color:gray\">-</span>StrictMode <span style=\"color:gray\">-</span>Version Latest;\r\nipmo d:\\DDN_docs\\scripts\\powershell\\auto\\UIAutomation.0.7.11.NET35\\UIAutomation.dll \r\nipmo d:\\DDN_docs\\scripts\\powershell\\auto\\UIAutomation.0.7.11.NET35\\TMX.dll \r\n\r\n<span style=\"color:green\">#[UIAutomation.Mode]::Profile = [UIAutomation.Modes]::Presentation;</span>\r\n<span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Mode</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Profile <span style=\"color:gray\">=</span> <span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Modes</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Normal;\r\n\r\nStart<span style=\"color:gray\">-</span>Process <span style=\"color:#a31515\">&quot;compmgmt.msc&quot;</span> <span style=\"color:gray\">-</span>PassThru | Get<span style=\"color:gray\">-</span>UIAWindow; \r\n\r\nGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Shared Folders'</span> | `\r\n    Invoke<span style=\"color:gray\">-</span>UIAMenuItemExpand | `\r\n        Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Shares'</span> | `\r\n            Invoke<span style=\"color:gray\">-</span>UIAMenuItemExpand;\r\n<span style=\"color:orangered\">$SharedItems</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIADataGrid <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'SysListView32'</span> | `\r\n    Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType DataItem;\r\n<span style=\"color:green\">#Listing shares                     </span>\r\n<span style=\"color:blue\">foreach</span> (<span style=\"color:orangered\">$Item</span> <span style=\"color:blue\">in</span> <span style=\"color:orangered\">$SharedItems</span>) {\r\n    Get<span style=\"color:gray\">-</span>UIADataGrid <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'SysListView32'</span> | `\r\n        Get<span style=\"color:gray\">-</span>UIADataItem <span style=\"color:gray\">-</span>Name $(<span style=\"color:orangered\">$Item</span>.Current.Name) | `\r\n            Invoke<span style=\"color:gray\">-</span>UIAControlClick <span style=\"color:gray\">-</span>RightClick;\r\n    <span style=\"color:#a31515\">&quot;Right button pressed...&quot;</span> | Write<span style=\"color:gray\">-</span>Host    \r\n    <span style=\"color:blue\">break</span>\r\n}\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-06-25T03:13:04.98-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853165",
    "ThreadId": "360789",
    "Html": "<p>Hi, technically, it waits.</p>\r\n<p>But there is a problem: a menu grown from the main menu or a context menu is also a window. Cmdlets do their best, but there is a practical observation: set [UIAutomation.Preferences]::OnSuccessDelay between 100 and 200. Something like dificulty to get a window (menu) by nothing (it doesn't have name of appropriate automaitonid).</p>\r\n<p>I dodn't investigate into it (there always was a bunch of other things to investigate into), just an observation.</p>\r\n<p>&nbsp;</p>\r\n<p>If it slow down all your test suite, set it for a piece of code.</p>\r\n<p>(The version 0.7.12, possibly, introduces a good work with cache requests, I hope, and for applications with a lot of controls it promises to accelerate queries.)</p>\r\n<p>Another thing, that is still in development is profiles. This means that such settings as OnSucessDelay will be set on a window or a container level (for example, for Pane). This will mean that slowing down caused by OnSuccessDelay=200 will be minimized.</p>",
    "PostedDate": "2012-06-25T04:28:23.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853210",
    "ThreadId": "360789",
    "Html": "<p>Oops! Sorry,&nbsp;<a class=\"UserProfileLink\" href=\"http://www.codeplex.com/site/users/view/JUSTASM\">JUSTASM</a>, you have found a bug! :) I changed PostMessage to SendMessage in a method that is under Invoke-UIAControlClick cmdlet (and Invoke-UIAControlContextMenu as well).</p>\r\n<p>I put PostMessage in place and your code works now. (My first thought was that a menu (i.e., a window that is a menu) is not painted when the code goes further. But you were right, mouse movement helped here as it 'pushed' the queue of messages that SendMessage was awaiting, as I think).</p>\r\n<p>I'd like to suggest a couple changes to your code, if you's allow:</p>\r\n<p>Variant 1:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">foreach</span> (<span style=\"color: orangered;\">$Item</span> <span style=\"color: blue;\">in</span> <span style=\"color: orangered;\">$SharedItems</span>) {\r\n\tWrite<span style=\"color: gray;\">-</span>Host <span style=\"color: orangered;\">$Item</span>.Current.Name;\r\n    <span style=\"color: blue;\">if</span> (Get<span style=\"color: gray;\">-</span>UIADataGrid <span style=\"color: gray;\">-</span>Class <span style=\"color: #a31515;\">'SysListView32'</span> | `\r\n        Get<span style=\"color: gray;\">-</span>UIADataItem <span style=\"color: gray;\">-</span>Name $(<span style=\"color: orangered;\">$Item</span>.Current.Name) | `\r\n            Invoke<span style=\"color: gray;\">-</span>UIAControlClick <span style=\"color: gray;\">-</span>RightClick <span style=\"color: gray;\">-</span>PassThru:<span style=\"color: orangered;\">$false</span>) {\r\n\t\t<span style=\"color: #a31515;\">\"Right button pressed...\"</span> | Write<span style=\"color: gray;\">-</span>Host\r\n\t} <span style=\"color: blue;\">else</span> {\r\n\t\t<span style=\"color: #a31515;\">\"Right button failed...\"</span> | Write<span style=\"color: gray;\">-</span>Host\r\n    }\r\n    <span style=\"color: green;\">#break</span>\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Invoke- cmlets are able to return the AutomationObject they have been invoking pattern on as well as $true/$false for confitions like if. This sample should better response to what happens in the application.</p>\r\n<p>The result is a logical sum of boolean results of the first PostMesssage (WM_xxBUTTONDOWN) and the second (WM_xxBUTTONUP).</p>\r\n<p>Variant 2:</p>\r\n<p>there is a special cmdlet for context menu that does the same (right click upon the geometrical center of a control).</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">foreach</span> (<span style=\"color: orangered;\">$Item</span> <span style=\"color: blue;\">in</span> <span style=\"color: orangered;\">$SharedItems</span>) {\r\n\tWrite<span style=\"color: gray;\">-</span>Host <span style=\"color: orangered;\">$Item</span>.Current.Name;\r\n    Get<span style=\"color: gray;\">-</span>UIADataGrid <span style=\"color: gray;\">-</span>Class <span style=\"color: #a31515;\">'SysListView32'</span> | `\r\n        Get<span style=\"color: gray;\">-</span>UIADataItem <span style=\"color: gray;\">-</span>Name $(<span style=\"color: orangered;\">$Item</span>.Current.Name) | `\r\n            Invoke<span style=\"color: gray;\">-</span>UIAControlContextMenu\r\n\t<span style=\"color: #a31515;\">\"Right button pressed...\"</span> | Write<span style=\"color: gray;\">-</span>Host\r\n    <span style=\"color: green;\">#break</span>\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>both samples have been tested with&nbsp;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: gray;\">[</span><span style=\"color: teal;\">UIAutomation.Preferences</span><span style=\"color: gray;\">]</span><span style=\"color: gray;\">::</span>OnSuccessDelay <span style=\"color: gray;\">=</span> 0;\r\n</pre>\r\n</div>\r\n(the same the Normal mode sets)</p>",
    "PostedDate": "2012-06-25T07:07:19.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853247",
    "ThreadId": "360789",
    "Html": "<p>OK, I use menus instead of mouse, and hope changes are committed in next build. You're doing great tool, thanks!</p>",
    "PostedDate": "2012-06-25T08:57:47.947-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]