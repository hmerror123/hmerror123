[
  {
    "Id": "853267",
    "ThreadId": "360839",
    "Html": "\r\n<p>I try to get &nbsp;UIASpinnerValue:</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:orangered\">$UserLimit</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow  <span style=\"color:gray\">-</span>Name <span style=\"color:orangered\">$WindowName</span> | `\r\n                                Get<span style=\"color:gray\">-</span>UIASpinner <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'User limit'</span> | `\r\n                                    Get<span style=\"color:gray\">-</span>UIASpinnerValue                    \r\n<span style=\"color:orangered\">$UserLimit</span>                                                               \r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>but always have &quot;&quot;.</p>\r\n<p>Here the whole script (it takes user limit from properties of ordinary share, so it requires at least one ordinary share with non maximum allowed users in properties).</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>Set<span style=\"color:gray\">-</span>StrictMode <span style=\"color:gray\">-</span>Version Latest;\r\n\r\nipmo d:\\DDN_docs\\scripts\\powershell\\auto\\UIAutomation.0.7.11.NET35\\UIAutomation.dll \r\nipmo d:\\DDN_docs\\scripts\\powershell\\auto\\UIAutomation.0.7.11.NET35\\TMX.dll \r\n\r\n<span style=\"color:green\">#[UIAutomation.Mode]::Profile = [UIAutomation.Modes]::Presentation;</span>\r\n<span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Mode</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Profile <span style=\"color:gray\">=</span> <span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Modes</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Normal;\r\n<span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Preferences</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Timeout <span style=\"color:gray\">=</span> 1000;\r\n\r\n<span style=\"color:green\">#Open Remote computer management</span>\r\n<span style=\"color:orangered\">$MainWindow</span> <span style=\"color:gray\">=</span> Start<span style=\"color:gray\">-</span>Process <span style=\"color:#a31515\">&quot;compmgmt.msc&quot;</span> <span style=\"color:gray\">-</span>PassThru | Get<span style=\"color:gray\">-</span>UIAWindow; \r\n\r\n<span style=\"color:green\">#Expand Shared Folders</span>\r\n<span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Shared Folders'</span> | `\r\n            Invoke<span style=\"color:gray\">-</span>UIAMenuItemExpand \r\n\r\n<span style=\"color:green\">#Expand Shares</span>\r\n<span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Shares'</span> | `\r\n            Invoke<span style=\"color:gray\">-</span>UIAMenuItemExpand \r\n\r\n<span style=\"color:green\">#Get Shares</span>\r\n<span style=\"color:orangered\">$SharedItems</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIADataGrid <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'SysListView32'</span> | `\r\n                    Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType DataItem;\r\n\r\n<span style=\"color:blue\">foreach</span> (<span style=\"color:orangered\">$Item</span> <span style=\"color:blue\">in</span> <span style=\"color:orangered\">$SharedItems</span>) {\r\n    <span style=\"color:green\">#Write ShareItem Name    </span>\r\n    <span style=\"color:green\">#Select ShareItem      </span>\r\n    <span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>ProcessId <span style=\"color:orangered\">$MainWindow</span>.Current.ProcessId | `\r\n                Get<span style=\"color:gray\">-</span>UIADataGrid <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'SysListView32'</span> | `\r\n                    Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType DataItem | `\r\n                        Get<span style=\"color:gray\">-</span>UIADataItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">&quot;$($Item.Current.Name)&quot;</span> | `\r\n                            Invoke<span style=\"color:gray\">-</span>UIADataItemSelectItem <span style=\"color:gray\">-</span>ItemName <span style=\"color:#a31515\">&quot;$($Item.Current.Name)&quot;</span>  \r\n    <span style=\"color:green\">#Open Properies Window        </span>\r\n    <span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>ProcessId <span style=\"color:orangered\">$MainWindow</span>.Current.ProcessId | `\r\n                Get<span style=\"color:gray\">-</span>UIAToolBar <span style=\"color:gray\">-</span>ControlType MenuBar | `\r\n                    Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Action'</span> | `\r\n                        Invoke<span style=\"color:gray\">-</span>UIAMenuItemClick | `\r\n                            Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Properties'</span> | `\r\n                                Invoke<span style=\"color:gray\">-</span>UIAMenuItemClick                                    \r\n         \r\n    <span style=\"color:green\">#Check if Share is Special Share</span>\r\n    <span style=\"color:orangered\">$WindowName</span> <span style=\"color:gray\">=</span> <span style=\"color:#a31515\">&quot;$($Item.Current.Name) Properties&quot;</span>\r\n    <span style=\"color:orangered\">$IsSpecialShare</span> <span style=\"color:gray\">=</span> <span style=\"color:orangered\">$False</span>\r\n    <span style=\"color:blue\">try</span> {         \r\n        <span style=\"color:green\">#If it is a special share, close notify and properties window</span>\r\n        <span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Shared Folders'</span> | `\r\n            Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'Button'</span> <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | `\r\n                Invoke<span style=\"color:gray\">-</span>UIAButtonClick                               \r\n        <span style=\"color:orangered\">$IsSpecialShare</span> <span style=\"color:gray\">=</span> <span style=\"color:orangered\">$True</span>                \r\n    }\r\n    <span style=\"color:blue\">catch</span> {\r\n    }\r\n    <span style=\"color:green\">#If it is not a special share, write out its properties    </span>\r\n    <span style=\"color:blue\">if</span> (!<span style=\"color:orangered\">$IsSpecialShare</span>) {                      \r\n        <span style=\"color:orangered\">$UserLimitB</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:orangered\">$WindowName</span> | `\r\n                Get<span style=\"color:gray\">-</span>UIARadioButton <span style=\"color:gray\">-</span>Class <span style=\"color:#a31515\">'Button'</span> <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Maximum allowed'</span> | `\r\n                    Get<span style=\"color:gray\">-</span>UIARadioButtonSelectionItemState      \r\n        <span style=\"color:orangered\">$UserLimitB</span>\r\n        <span style=\"color:blue\">if</span> (<span style=\"color:orangered\">$UserLimitB</span> <span style=\"color:gray\">-eq</span> <span style=\"color:orangered\">$True</span>) {\r\n            <span style=\"color:orangered\">$UserLimit</span> <span style=\"color:gray\">=</span> 0                    \r\n        }\r\n        <span style=\"color:blue\">else</span> {\r\n            <span style=\"color:gray\">[</span><span style=\"color:teal\">int</span><span style=\"color:gray\">]</span><span style=\"color:orangered\">$UserLimit</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow  <span style=\"color:gray\">-</span>Name <span style=\"color:orangered\">$WindowName</span> | `\r\n                                Get<span style=\"color:gray\">-</span>UIASpinner <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'User limit'</span> | `\r\n                                    Get<span style=\"color:gray\">-</span>UIASpinnerValue                    \r\n            <span style=\"color:orangered\">$UserLimit</span>                                                               \r\n        }        \r\n    }\r\n    <span style=\"color:orangered\">$Null</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:orangered\">$WindowName</span> | `\r\n                Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Close'</span> | `\r\n                    Invoke<span style=\"color:gray\">-</span>UIAButtonClick                \r\n}\r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-06-25T10:14:49.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853275",
    "ThreadId": "360839",
    "Html": "<p>I have not tried the script yet, I've only observed what the spinner is.</p>\r\n<p>I'm sitting now on Windows 8 RP and UIAutomationSpy says that this spinner supports only RangeValuePatten (not every control and in not every time a control supports all the patterns it theoretically can).</p>\r\n<p>This works:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>Get<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: gray;\">*</span>user<span style=\"color: gray;\">*</span>prop<span style=\"color: gray;\">*</span> | Get<span style=\"color: gray;\">-</span>UIASpinner <span style=\"color: gray;\">-</span>Name <span style=\"color: gray;\">*</span>user<span style=\"color: gray;\">*</span>lim<span style=\"color: gray;\">*</span> | Get<span style=\"color: gray;\">-</span>UIASpinnerRangeValue\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-06-25T10:59:01.113-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853585",
    "ThreadId": "360839",
    "Html": "<p>Thanks! It works!</p>",
    "PostedDate": "2012-06-25T23:10:42.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]