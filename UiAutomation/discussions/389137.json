[
  {
    "Id": "891666",
    "ThreadId": "389137",
    "Html": "\r\n<div style=\"background-color:white; color:black\"></div>\r\n<p>Hi, I just began working with UIAutomation module for Powershell.</p>\r\n<p>My goal is to automate configuration of MSMQ in windows server (w2k8/w2k8r2)</p>\r\n<p>I almost reached it. Here is my code</p>\r\n<pre>Get-UIAWindow -Name 'Server Manager' | `\r\n\tGet-UIAChildWindow -AutomationId '65280' -Name 'Server Manager (SEGOTNL669)' | `\r\n\tGet-UIATree -AutomationId '12785' | `\r\n\tGet-UIATreeItem -Name 'Server Manager (SEGOTNL669)' -TimeOut 10000 | `\r\n\tGet-UIATreeItem -Name 'Roles' -TimeOut 10000 | Invoke-UIATreeItemExpand | `\r\n\tGet-UIATreeItem -Name 'Application Server' -TimeOut 10000 | Invoke-UIATreeItemExpand | `\r\n\tGet-UIATreeItem -Name 'Message Queuing' -Timeout 10000 | % {$_.setfocus()}\r\n\tShow-UIAContextMenu\r\n\tGet-UIAWindow -Name 'Menu' | Get-UIAMenuItem -AutomationId 'Item 1016' -Name 'Properties' | Invoke-UIAMenuItemClick\r\n\t\r\n\tGet-UIAWindow -Name 'Message Queuing Properties' | `\r\n\tGet-UIATab -AutomationId '12320' | `\r\n\tGet-UIATabItem -Name 'Storage' | `\r\n\tGet-UIAEdit -AutomationId '10780' -Name 'Message files folder:' | Set-UIAEditText -Text 'D:\\Logs\\MSMQ\\Storage'\r\n\tGet-UIAEdit -AutomationId '10782' -Name 'Message logger folder:' | Set-UIAEditText -Text 'D:\\Logs\\MSMQ\\Storage'\r\n\tGet-UIAEdit -AutomationId '10781' -Name 'Transaction logger folder:' | Set-UIAEditText -Text 'D:\\Logs\\MSMQ\\Storage'\r\n\tGet-UIAButton -AutomationId '1' -Name 'OK' | Invoke-UIAButtonClick</pre>\r\n<p>&nbsp;</p>\r\n<p>After execution of this code,there&nbsp;appears warning window asking for confirmation.</p>\r\n<p>And I don't know how to click OK on it and get rid of it</p>\r\n<p>Any help appreciated</p>\r\n",
    "PostedDate": "2012-07-26T06:26:06.29-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "891845",
    "ThreadId": "389137",
    "Html": "<p>Hello <a class=\"UserProfileLink\" href=\"http://www.codeplex.com/site/users/view/blindrood\">blindrood</a>&nbsp;,</p>\r\n<p>I can't watch your code in action and help you much right now as I'm sitting on an old Vista-32 notebook (with a couple of&nbsp;<br />letters broken, and I hit buttons as on legacy mechanical typewriter :)) in the summer cabin, so that I'll try to give you&nbsp;<br />several general tips.</p>\r\n<p>Assuming that the warning is a dialog, not a UAC &nbsp;request:</p>\r\n<p>1) You can try the Get-UIAChildWindow cmdlet, with or without parameters. The cmdlet works similarly to Get-UIA[ControlType]&nbsp;<br />cmdlets, not like the Get-UIAWindow cmdlet, giving you the oppoprtunity to use the following parameters: -Name, -AutomationID,&nbsp;<br />-Class.</p>\r\n<p>Please note that applications like MMC may contain several internal windows</p>\r\n<p>2) Supposing that your code is running minimized (for example, start /wait /min powershell.exe -command { your_script;} ), you&nbsp;<br />might try the Get-UIAActiveWindow cmdlet (it's very unstable thing as it relies on the current focus only. Sometimes, it helps).3) The right way is to use the Register-UIAWindowOpenedEvent cmdlet, for example, somewhere several seconds before the dialog&nbsp;<br />appears:</p>\r\n<p>$your_server_manager_window | Register-UIAWindowOpenedEvent -EventAction { param($src, $e) try { $src | Get-UIAButton -n OK |&nbsp;<br />Invoke-UIAButtonClick; } catch {} }Please refer to these blog posts:</p>\r\n<p>http://softwaretestingusingpowershell.com/2012/02/12/uiautomation-getting-events/</p>\r\n<p>http://softwaretestingusingpowershell.com/2012/06/28/daily-automaiton-how-to-deal-with-windows/</p>\r\n<p>I shed a drop of light there on handling 'surprise!' windows.</p>\r\n<p>4) you can try to get all the sub-windows in your window and choose which is the dialog you are hunting down:</p>\r\n<p>$your_server_manager_window | Get-UIAControlDescendants -ControlType Window | %{ ... }</p>\r\n<p>I'd like also to give you several tips on coding for the UIAutomation module:</p>\r\n<p>1) cut out -AutomationID and -Class wherever it possible. Nobody guarantees that another version of Windows have the same Ids&nbsp;<br />onboard.&nbsp;If you have only one tree in the app, simply use Get-UIATreecontext menu items may or may not have the same AutomationId (I'm about \"'Item 1016'\") on next run.Please cut them out.</p>\r\n<p>The more you managed to cut, the better is your code.UIAutomationSpy/Start-UIARecorder generate all that they can catch.</p>\r\n<p>2) Use more wildcards, 'Server Manager (SEGOTNL669)' -&gt; 'Server*Man*', with or without apostrophes/quotes. It's case-<br />insensitive, the capitals are just for better reading.Your code will be more stable and portable.</p>\r\n<p>3) If you need to change the default timeout for a time, there is the setting:</p>\r\n<p>[UIAutomation.Preferences]::Timeout (in milliseconds)</p>",
    "PostedDate": "2012-07-26T10:00:34.543-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892106",
    "ThreadId": "389137",
    "Html": "\r\n<p>Hi, thanks for Your huge response.</p>\r\n<p>I found that it was my mistake.</p>\r\n<p>This window didn't have 'OK' button but 'Yes' :D</p>\r\n<p>I didn't notice that yesterday and today with a fresh mind I found it</p>\r\n<p>UIAtomation is a great tool :)</p>\r\n<p>However I seem to have one more problem</p>\r\n<p><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"></span></span></span></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-family:Courier New; color:#800000; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\">Here's how it looks</span></span></p>\r\n<p><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\">&#65279;</span></span></span></span></span></span></span></span></span></span><a href=\"http://i.imgur.com/PJBTr.png\">http://i.imgur.com/PJBTr.png</a></p>\r\n<p></p>\r\n<p style=\"background-color:white; color:black\">&nbsp;</p>\r\n<pre>\tGet<span style=\"color:gray\">-</span>UIATabItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Storage'</span> | \r\n\tGet<span style=\"color:gray\">-</span>UIAEdit <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message files folder:'</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">'D:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAEdit <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message logger folder:'</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">'D:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAEdit <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Transaction logger folder:'</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">'D:\\Logs\\MSMQ\\Storage'</span>\r\n</pre>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"><span style=\"font-family:Courier New; font-size:small\"></p>\r\n<p>In this part of code 2 last edittexts are set but first one, 'Message files folder:' seems to have problem</p>\r\n&nbsp;</span></span></span><span style=\"font-family:Courier New; color:#800000; font-size:small\"><span style=\"font-family:Courier New; color:#800000; font-size:small\">&nbsp;</span></span></span></span></span><span style=\"font-family:Courier New; color:#800000; font-size:small\">&nbsp;</span></span></span></span><span style=\"font-family:Courier New; color:#800000; font-size:small\"></span>\r\n<p></p>\r\n",
    "PostedDate": "2012-07-27T00:38:58.977-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892350",
    "ThreadId": "389137",
    "Html": "<p>Hello <a class=\"UserProfileLink\" href=\"http://www.codeplex.com/site/users/view/blindrood\">blindrood</a>&nbsp;,</p>\r\n<p>luckily, I'm today in the city and I vpn'ed to a Windows 2008 SP2 x64 host to watch what's the problem.</p>\r\n<p>I found that the Properties window throws out the value of the first text box if the drive letter is not usable. When I changed letter to C: and created the folder Logs (without inner structure), it filled all the three boxes and asked me for creating a folder.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>Get<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Man*'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIAChildWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Man*'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATree | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Mana*'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Roles'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | Invoke<span style=\"color: gray;\">-</span>UIATreeItemExpand | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Appl*Server'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | Invoke<span style=\"color: gray;\">-</span>UIATreeItemExpand | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Mess*Queu*'</span> <span style=\"color: gray;\">-</span>Timeout 10000 | `\r\n    Invoke<span style=\"color: gray;\">-</span>UIAControlContextMenu | `\r\n    Get<span style=\"color: gray;\">-</span>UIAMenuItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Properties'</span> | Invoke<span style=\"color: gray;\">-</span>UIAMenuItemClick\r\n\t\r\n\tGet<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Mess*Queu*Properties'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATabItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Storage'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Message*files*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Message*logger*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Transaction*logger*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAButton <span style=\"color: gray;\">-</span>AutomationId <span style=\"color: #a31515;\">'1'</span> <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'OK'</span> | Invoke<span style=\"color: gray;\">-</span>UIAButtonClick\r\n</pre>\r\n</div>\r\n</p>\r\n<p>A couple of notes:</p>\r\n<p>1) The Show-UIAContextMenu cmdlet is a legacy or interim cmdlet, I even forgot about its existence. :) The right cmdlet for invoking a context menu is Invoke-UIAControlContextMenu, that accepts an AutomaitonElement as input&nbsp;and returns the menu window AutomationElement, so that the pipeline is uninterruptible from a tree node to a menu item.</p>\r\n<p>2) There are integrated delays after every cmdlet (the default mode is Presentation). You can set, if necessary, the following setting: [UIAutomation.Preferences]::OnSuccessDelay = 0</p>\r\n<p>3) These text boxes are examples of UI Automation-unfriendly programming. Why? An Edit does not have name, usually, The string that is visible as its name is no more than a LabeledBy from the nearest Text (i.e., label). Actually, the name of a text box is the text inside. And only when there's no text inside, the name is the name of the next to label.</p>\r\n<p>The UIAutomation-friendly programming is setting a good automationId to each text box. Unfortunately, there is no better way to fill in text boxes except getting them by 'name'.</p>\r\n<p><strong>The first way I would recommend here</strong> is to put the values twice, i.e. fill in the first, the second, the third and again the first text boxes.</p>\r\n<p><strong>The second way</strong> is to get all three text boxes&nbsp;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>Get<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Mess*Queu*Properties'</span> | `\r\n    Get<span style=\"color: gray;\">-</span>UIATabItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Storage'</span> | `\r\n    Invoke<span style=\"color: gray;\">-</span>UIAControlClick | `\r\n    Get<span style=\"color: gray;\">-</span>UIAControlDescendants <span style=\"color: gray;\">-</span>ControlType Edit | <span style=\"color: gray;\">%</span>{ ... }\r\n</pre>\r\n</div>\r\nafter that get the text box with the least $_.Current.BoundingRectangle.Y, this will be the first, and so on.</p>\r\n<p>Finally, my version is:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>cls;\r\n<span style=\"color: gray;\">[</span><span style=\"color: teal;\">UIAutomation.Preferences</span><span style=\"color: gray;\">]</span><span style=\"color: gray;\">::</span>OnSuccessDelay <span style=\"color: gray;\">=</span> 0\r\nGet<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Man*'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIAChildWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Man*'</span> | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATree | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Server*Mana*'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Roles'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | Invoke<span style=\"color: gray;\">-</span>UIATreeItemExpand | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Appl*Server'</span> <span style=\"color: gray;\">-</span>TimeOut 10000 | Invoke<span style=\"color: gray;\">-</span>UIATreeItemExpand | `\r\n\tGet<span style=\"color: gray;\">-</span>UIATreeItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Mess*Queu*'</span> <span style=\"color: gray;\">-</span>Timeout 10000 | `\r\n    Invoke<span style=\"color: gray;\">-</span>UIAControlContextMenu | `\r\n    Get<span style=\"color: gray;\">-</span>UIAMenuItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Properties'</span> | Invoke<span style=\"color: gray;\">-</span>UIAMenuItemClick\r\n\t\r\n\tGet<span style=\"color: gray;\">-</span>UIAWindow <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Mess*Queu*Properties'</span> | `\r\n    Get<span style=\"color: gray;\">-</span>UIATabItem <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Storage'</span> | `\r\n    Invoke<span style=\"color: gray;\">-</span>UIAControlClick | `\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Message*files*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Message*logger*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAEdit <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'Transaction*logger*'</span> | Set<span style=\"color: gray;\">-</span>UIAEditText <span style=\"color: gray;\">-</span>Text <span style=\"color: #a31515;\">'C:\\Logs\\MSMQ\\Storage'</span>\r\n\tGet<span style=\"color: gray;\">-</span>UIAButton <span style=\"color: gray;\">-</span>AutomationId <span style=\"color: #a31515;\">'1'</span> <span style=\"color: gray;\">-</span>Name <span style=\"color: #a31515;\">'OK'</span> | Invoke<span style=\"color: gray;\">-</span>UIAButtonClick\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-07-27T10:12:02.65-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892884",
    "ThreadId": "389137",
    "Html": "\r\n<p>Hi again,</p>\r\n<p>I did some more modifications and it looks now that</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre><span style=\"color:blue\">filter</span> Write<span style=\"color:gray\">-</span>Log {<span style=\"color:orangered\">$_</span> | Out<span style=\"color:gray\">-</span>Null}\r\nNew<span style=\"color:gray\">-</span>Item <span style=\"color:gray\">-</span>Path D:\\Logs <span style=\"color:gray\">-</span>ItemType directory <span style=\"color:gray\">-</span>ErrorAction SilentlyContinue | Write<span style=\"color:gray\">-</span>Log\r\nNew<span style=\"color:gray\">-</span>Item <span style=\"color:gray\">-</span>Path D:\\Logs\\msmq <span style=\"color:gray\">-</span>ItemType directory <span style=\"color:gray\">-</span>ErrorAction SilentlyContinue | Write<span style=\"color:gray\">-</span>Log\r\nInvoke<span style=\"color:gray\">-</span>Item <span style=\"color:orangered\">$env:SystemRoot</span>\\system32\\servermanager.msc\r\nStart<span style=\"color:gray\">-</span>Sleep 8\r\n<span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Preferences</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>Timeout <span style=\"color:gray\">=</span> 15000\r\n<span style=\"color:gray\">[</span><span style=\"color:teal\">UIAutomation.Preferences</span><span style=\"color:gray\">]</span><span style=\"color:gray\">::</span>OnSuccessDelay <span style=\"color:gray\">=</span> 0\r\nGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Server*Manager*'</span> |  Get<span style=\"color:gray\">-</span>UIATree | \r\n\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Roles'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Application*'</span> <span style=\"color:gray\">-</span>TimeOut 20000 | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message*Q*'</span> |\r\n\tInvoke<span style=\"color:gray\">-</span>UIAControlContextMenu | Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Properties'</span> | Invoke<span style=\"color:gray\">-</span>UIAMenuItemClick\r\n\r\n\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message Queuing Properties'</span> | Get<span style=\"color:gray\">-</span>UIATab | Get<span style=\"color:gray\">-</span>UIATabItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Storage'</span> | Invoke<span style=\"color:gray\">-</span>UIATabItemSelectItem <span style=\"color:gray\">-</span>ItemName <span style=\"color:#a31515\">'Storage'</span> | Write<span style=\"color:gray\">-</span>Log\r\n\tGet<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType Edit | ForEach<span style=\"color:gray\">-</span>Object {\r\n\t\t<span style=\"color:orangered\">$_</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">'D:\\Logs\\MSMQ\\Storage'</span> | Write<span style=\"color:gray\">-</span>Log\r\n\t}\r\n\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n\t<span style=\"color:blue\">do</span>{\r\n\t\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message*'</span> | Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType Window | ForEach<span style=\"color:gray\">-</span>Object {\r\n\t\t\t\t<span style=\"color:blue\">try</span>{<span style=\"color:orangered\">$_</span> | Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Yes'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick | Write<span style=\"color:gray\">-</span>Log}<span style=\"color:blue\">catch</span>{}\r\n\t\t\t\t<span style=\"color:blue\">try</span>{<span style=\"color:orangered\">$_</span> | Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick | Write<span style=\"color:gray\">-</span>Log}<span style=\"color:blue\">catch</span>{}\r\n\t\t}\r\n\t\t<span style=\"color:orangered\">$list</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message*'</span> | Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType Window\r\n\t}\r\n\t<span style=\"color:blue\">while</span> (<span style=\"color:orangered\">$list</span>)\r\nStop<span style=\"color:gray\">-</span>Process <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'mmc'</span>\r\n</pre>\r\n</div>\r\n<p>It works fine, but do-while loop takes a lot of time (comparing to previous lines). I do this because there appear about 4 confirm windows (3 with OK, one with YES ;) )&nbsp;one after another.</p>\r\n<p>If You know a way how to speed up this process I'll be gratefull</p>\r\n<p>I also created a way to add private que:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">#region create que</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Server*Manager*'</span> |  Get<span style=\"color:gray\">-</span>UIATree | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Roles'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Application*'</span> <span style=\"color:gray\">-</span>TimeOut 20000 | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message*Q*'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand |\r\n\t    Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Private*'</span> | \r\n\t    Invoke<span style=\"color:gray\">-</span>UIAControlContextMenu | Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'New'</span> | Invoke<span style=\"color:gray\">-</span>UIAMenuBarExpand | \r\n\t    Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Private*'</span> | Invoke<span style=\"color:gray\">-</span>UIAMenuItemClick\r\n\tStart<span style=\"color:gray\">-</span>Sleep 1\r\n\tGet<span style=\"color:gray\">-</span>UIAEdit <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Que*'</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">$Name</span>\r\n\tGet<span style=\"color:gray\">-</span>UIACheckBox <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Transactional'</span> | Invoke<span style=\"color:gray\">-</span>UIACheckBoxToggle\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n<span style=\"color:green\">#endregion</span>\r\n\r\n<span style=\"color:green\">#region set que properties</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Server*Manager*'</span> |  Get<span style=\"color:gray\">-</span>UIATree | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Roles'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Application*'</span> <span style=\"color:gray\">-</span>TimeOut 20000 | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\t\tGet<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Message*Q*'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand |\r\n\t    Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Private*'</span> | Invoke<span style=\"color:gray\">-</span>UIATreeItemExpand | \r\n\t    Get<span style=\"color:gray\">-</span>UIATreeItem <span style=\"color:gray\">-</span>Name <span style=\"color:orangered\">$Name</span> | Invoke<span style=\"color:gray\">-</span>UIAControlContextMenu | \r\n\t    Get<span style=\"color:gray\">-</span>UIAMenuItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Properties'</span> | Invoke<span style=\"color:gray\">-</span>UIAMenuItemClick\r\n\t    \r\n\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">&quot;$($Name)*&quot;</span> | \r\n\tGet<span style=\"color:gray\">-</span>UIAPane <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Journal'</span> | \r\n\tGet<span style=\"color:gray\">-</span>UIACheckBox <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Limit*journal*'</span> | Invoke<span style=\"color:gray\">-</span>UIACheckBoxToggle\r\n\tstart<span style=\"color:gray\">-</span>sleep 1\r\n\tGet<span style=\"color:gray\">-</span>UIAPane <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Journal'</span> |  Get<span style=\"color:gray\">-</span>UIAEdit <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Journal'</span> | Set<span style=\"color:gray\">-</span>UIAEditText <span style=\"color:gray\">-</span>Text <span style=\"color:#a31515\">'5000'</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Apply'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n<span style=\"color:green\">#endregion</span>\r\n\r\n<span style=\"color:green\">#region set que permissions</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">&quot;$($Name)*&quot;</span> | Get<span style=\"color:gray\">-</span>UIATab | Get<span style=\"color:gray\">-</span>UIATabItem <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Security'</span> | \r\n\tInvoke<span style=\"color:gray\">-</span>UIATabItemSelectItem <span style=\"color:gray\">-</span>ItemName <span style=\"color:#a31515\">'Security'</span>\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Add*'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n\t\t<span style=\"color:orangered\">$elem</span> <span style=\"color:gray\">=</span> Get<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">&quot;$($Name)*&quot;</span> | Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType Window \r\n\t\t<span style=\"color:orangered\">$elem</span> | Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>controltype document | Set<span style=\"color:gray\">-</span>UIAControlText <span style=\"color:gray\">-</span>Text <span style=\"color:orangered\">$user</span> | Write<span style=\"color:gray\">-</span>Log\r\n\t\t<span style=\"color:orangered\">$elem</span> | Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n\t\t<span style=\"color:blue\">try</span>{<span style=\"color:orangered\">$elem</span> | Get<span style=\"color:gray\">-</span>UIAControlDescendants <span style=\"color:gray\">-</span>ControlType Window | Get<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick | Write<span style=\"color:gray\">-</span>Log}<span style=\"color:blue\">catch</span>{}\r\n\t\tGet<span style=\"color:gray\">-</span>UIAWindow <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">&quot;$($Name)*&quot;</span>| Get<span style=\"color:gray\">-</span>UIACheckBox <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Allow*Full*'</span> | Invoke<span style=\"color:gray\">-</span>UIACheckBoxToggle | Write<span style=\"color:gray\">-</span>Log\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'Apply'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n\tGet<span style=\"color:gray\">-</span>UIAButton <span style=\"color:gray\">-</span>Name <span style=\"color:#a31515\">'OK'</span> | Invoke<span style=\"color:gray\">-</span>UIAButtonClick\r\n<span style=\"color:green\">#endregion</span>\r\n</pre>\r\n</div>\r\n<p>I would like to know if I'm correctly using UIAutomation cmdlets.</p>\r\n<p>Thanks in advance</p>\r\n",
    "PostedDate": "2012-07-29T23:31:54.643-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892987",
    "ThreadId": "389137",
    "Html": "<p>Hello, I'm on an iPad now and can't test what I'm writing here. <br />Have you ever heard that Python'ians say about Python? It is with batteries included.<br />Similarly, the UIAutomation cmdlets (Get-UIAWindow, Get-UIA[ControlType], Wait-) are shipped with timeout 'inside'.<br />How does the timeout works? It is a do/while loop that works until a window of interest or a control is caught. If nothing was caught, the timeout fires a null exception and the pipeline stops.<br /><br />In your do/while loop, the first timeout is used partially (a Message* window), after that either the Yes-button or OK-button uses the full fifteen second-long timeout.<br /><br />How to improve the code: if you surely know what the order of dialogs is, you might simply set timeouts for dialogs (if time is not known):<br />Instead of the loop:<br />Get-UIAWindow -n Message* -seconds 120 | Get-UIAButton -n OK -seconds 2 | ...<br />Get-UIAWindow -n Message* -seconds 120 | Get-UIAButton -n Yes -seconds 2 | ...<br />(there is definitely a use case for supporting regular expressions! I've been pondering , the time I added wildcards, about the reason and failed to find out at least one. There would be great the instruction: -Name 'OK|Yes' )<br />The code that is above waits for a dialog and spends no more than 2-3 seconds (time for search plus the timeout) per button.<br /><br />The code is right, I have only two notes:<br />1. If the start-sleep function just sleeps, you may simply rely on the timeout of the next cmdlet. Or increase the timeout of the next cmdlet.<br />2. In the part of code with get descendants window and get a button, set a small timeout for Get-UIAButton -n ... as I did in the sample above.</p>",
    "PostedDate": "2012-07-30T05:05:18.943-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]