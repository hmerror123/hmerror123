<div class="wikidoc">For our experiments we will use calc.exe put in the Mortgage mode:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name View | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Worksheets | Move<span style="color:Gray;">-</span>UIACursor <span style="color:Gray;">-</span>X 3 <span style="color:Gray;">-</span>Y 3 | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Mortgage | Invoke<span style="color:Gray;">-</span>UIAMenuItemClick;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598637" alt="ReadingWritingText003.jpg" title="ReadingWritingText003.jpg" />
<h2>Getting the full list of items</h2>The only things you need to know here is that items in combo box are of type ListItem:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAComboBox | Get<span style="color:Gray;">-</span>UIAListItem | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div>The Read-UIAControlName cmdlet is here for readability only: if you need to get AutomationElements of items, yor code would be:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAComboBox | Get<span style="color:Gray;">-</span>UIAListItem;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598638" alt="ReadingWritingText004.jpg" title="ReadingWritingText004.jpg" />
<h2>Getting the selected item</h2><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAComboBox | Get<span style="color:Gray;">-</span>UIAComboBoxSelection | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div><h2>Selecting an item</h2>To select an item in combo box, we first need to get the item we want to select and, second, apply SelectItemPattern to the item. SelectItemPattern requires the name, so that we need to use the name twice:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAComboBox | Get<span style="color:Gray;">-</span>UIAListItem <span style="color:Gray;">-</span>Name term<span style="color:Gray;">*</span> | Invoke<span style="color:Gray;">-</span>UIAListItemSelectItem <span style="color:Gray;">-</span>ItemName term<span style="color:Gray;">*</span>
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598645" alt="ReadingWritingText005.jpg" title="ReadingWritingText005.jpg" /><br /><br />Tags: ControlType.Window, ControlType.MenuItem, ControlType.ComboBox, InvokePattern, ExpandCollapsePattern, move cursor, SelectionPattern, ControlType.ListItem, AutomationElement, SelectItemPattern</div><div class="ClearBoth"></div>