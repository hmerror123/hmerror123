<div class="wikidoc"><h2>Performing a click</h2>To click on a control, use a cmdlet with verb &#39;Invoke&#39; and part of noun &#39;Click&#39;:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name 1 | Invoke<span style="color:Gray;">-</span>UIAButtonClick;
</pre></div>In the sample above we clicked on the button 1. Now, we click on butttons 1,2, and 3:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">[</span><span style="color:Teal;">1-3</span><span style="color:Gray;">]</span> | Invoke<span style="color:Gray;">-</span>UIAButtonClick;
</pre></div>How does this work? The Get-UIAButton returns three controls with names 1, 2, and 3. The Invoke-UIAButtonClick cmdlet receives three controls and clicks on each.<br /><br />In versions prior to 0.8.3, to click on a control that does not support InvokePattern, we should use the Invoke-UIAControlClick cmdlet:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">[</span><span style="color:Teal;">1-3</span><span style="color:Gray;">]</span> | Invoke<span style="color:Gray;">-</span>UIAControlClick;
</pre></div><h2>Reading and writing text</h2>For these examples, let&#39;s turn Calculator in the Mortgage mode:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=597752" alt="ReadingWritingText001.jpg" title="ReadingWritingText001.jpg" /><br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name View | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Worksheets | Move<span style="color:Gray;">-</span>UIACursor <span style="color:Gray;">-</span>X 3 <span style="color:Gray;">-</span>Y 3 | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Mortgage | Invoke<span style="color:Gray;">-</span>UIAMenuItemClick;
</pre></div><h3>Writing text</h3>We will now write numbers into Edit elements, supposing that Calculator is running and prepared as shown above.<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc;
Get<span style="color:Gray;">-</span>UIAEdit <span style="color:Gray;">-</span>Name Purchase<span style="color:Gray;">*</span>price | Set<span style="color:Gray;">-</span>UIAEditText <span style="color:Gray;">-</span>Text 100;
Get<span style="color:Gray;">-</span>UIAEdit <span style="color:Gray;">-</span>Name Down<span style="color:Gray;">*</span>payment | Set<span style="color:Gray;">-</span>UIAEditText <span style="color:Gray;">-</span>Text 10;
Get<span style="color:Gray;">-</span>UIAEdit <span style="color:Gray;">-</span>Name Term<span style="color:Gray;">*</span>years<span style="color:Gray;">*</span> | Set<span style="color:Gray;">-</span>UIAEditText <span style="color:Gray;">-</span>Text 10;
Get<span style="color:Gray;">-</span>UIAEdit <span style="color:Gray;">-</span>Name Interest<span style="color:Gray;">*</span>rate<span style="color:Gray;">*</span> | Set<span style="color:Gray;">-</span>UIAEditText <span style="color:Gray;">-</span>Text 2;
Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name Calc<span style="color:Gray;">*</span> | Invoke<span style="color:Gray;">-</span>UIAButtonClick;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=597753" alt="ReadingWritingText002.jpg" title="ReadingWritingText002.jpg" />
<h3>Getting text</h3><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc;
Get<span style="color:Gray;">-</span>UIAEdit <span style="color:Gray;">-</span>Name Monthly<span style="color:Gray;">*</span>payment | Get<span style="color:Gray;">-</span>UIAEditText;
</pre></div><h2>Selecting an item</h2>

<h2>Scrolling an item</h2>ScrollItemPattern helps much if a control of interest is hidden. Here we run services.msc (via Run as Administrator or under credentials of an administrative account), on a Windows 7 box, where the BranchCache service row is out of the application screen:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process services.msc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIADataGrid | Get<span style="color:Gray;">-</span>UIADataItem <span style="color:Gray;">-</span>Name BranchCache | Invoke<span style="color:Gray;">-</span>UIADataItemScrollItem | Invoke<span style="color:Gray;">-</span>UIAControlContextMenu | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Properties | Invoke<span style="color:Gray;">-</span>UIAMenuItemClick;
</pre></div><br />Tags: ControlType.Window, ControlType.Button, InvokePattern, SendMessage, ExpandCollapsePattern, ControlType.MenuItem, move cursor, ScrollItemPattern</div><div class="ClearBoth"></div>