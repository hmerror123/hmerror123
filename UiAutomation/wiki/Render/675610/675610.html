<div class="wikidoc">In this exercise, we will use UIA Verify as a guide. UIA Verify demonstrates graphically how controls are placed in the Automation tree.<br />Let&#39;s run calc.exe and learn in detail how to get a button via pipeline. We are going to get the root of the system menu that can be called by pressing Alt+Space.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=597703" alt="Pipeline001.jpg" title="Pipeline001.jpg" /><br />The code below follows numbers that are on the picture:<br /><div style="color:Black;background-color:White;"><pre>
ipmo UIAutomation;
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIATitleBar | Get<span style="color:Gray;">-</span>UIAMenuBar | Get<span style="color:Gray;">-</span>UIAMenuItem | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div>This example shows how to get a control that is in parent-child relation to the previous one. <br />There is usually no need to write the full path, from control to control. This example does exactly the same the previous example did:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name System | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div>There is, however, no silver bullet in this choice: how many controls should be in the chain before we get successfully the control we&#39;re hunting down. Sometimes, it&#39;s enough to run code like<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIA<span style="color:Gray;">[</span><span style="color:Teal;">TargetControl</span><span style="color:Gray;">]</span>
</pre></div>in some situations, we should direct the search in a certain direction:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIA<span style="color:Gray;">[</span><span style="color:Teal;">SomeAnchorControl</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIA<span style="color:Gray;">[</span><span style="color:Teal;">AnotherAnchor</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIA<span style="color:Gray;">[</span><span style="color:Teal;">TargetControl</span><span style="color:Gray;">]</span>
</pre></div>In practice, we may need to get controls that are of a certain type and placed in a certain part of GUI, regardless names or automation ids.<br />Let&#39;s get menu items. The evident way is to run the following piece of code:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAMenuItem | Read<span style="color:Gray;">-</span>UIAControlName
</pre></div>The output consists of four menu items, three of them are what we were looking for (View, Edit, Help) and the fourth is what we have been playing around the first part of this tutorial. How to separate the first group of menu items (View, Edit, Help) from the System menu item?<br />Knowing their names, it&#39;s extremely easy:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name <span style="color:Gray;">[</span><span style="color:Teal;">veh</span><span style="color:Gray;">]</span><span style="color:Gray;">*</span> | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div>But what can we do if the app under test is localized or we aren&#39;t aware of names of controls, or controls simply does not have names? We need an anchor to direct our search in the right direction and bind the search to a certain location in the Automation tree.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=597719" alt="Pipeline002.jpg" title="Pipeline002.jpg" /><br />After having looked at the Automation tree, we know the answer: the menu bar &#39;Application&#39; is our anchor.<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAMenuBar <span style="color:Gray;">-</span>Name Applic<span style="color:Gray;">*</span> | Get<span style="color:Gray;">-</span>UIAMenuItem | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div>We are jumping to the menu bar and getting three and only three menu items, regardless their names. Great! This code will survive localization as the name of menu bar is not what the user sees (and therefore, it won&#39;t be changed during the localization).<br /><br />Tags: ControlType.Window, ControlType.TitleBar, ControlType.MenuBar, ControlType.MenuItem</div><div class="ClearBoth"></div>