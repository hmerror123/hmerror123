<div class="wikidoc">This type of search is also a native Automation query.<br /><br />The most traditional in PowerShell way is to pipeline a window to a Get-UIA[ControlType] cmdlet:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>n 1
</pre></div>Internally, every search by default is based on TreeScope.Descendants. For us, this means that we can (and sometimes must) use a series of searches. It&#39;s usually necessary in case a window has more than one child window (to flow search into the child window that we need)<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn <span style="color:OrangeRed;">$processName</span> | Get<span style="color:Gray;">-</span>UIAChildWindow | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name OK
</pre></div>or to refine search in case we are performing search by name and this name is not unique:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindows <span style="color:Gray;">-</span>pn <span style="color:OrangeRed;">$processName</span> | Get<span style="color:Gray;">-</span>UIATree | Get<span style="color:Gray;">-</span>UIATreeItem <span style="color:Gray;">-</span>Name <span style="color:OrangeRed;">$treeItemName</span>;
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn <span style="color:OrangeRed;">$processName</span> | Get<span style="color:Gray;">-</span>UIATabItem <span style="color:Gray;">-</span>Name <span style="color:#A31515;">&#39;Select computers&#39;</span> | Get<span style="color:Gray;">-</span>UIADataGrid | Get<span style="color:Gray;">-</span>UIADataItem <span style="color:Gray;">-</span>Name <span style="color:OrangeRed;">$hostname</span>;
</pre></div><br />The following parameters are available:
<ul><li>-Name (it&#39;s usually the visible label or the Name property as it&#39;s seen in SharpDevelop)</li>
<li>-AutomationId (this could be the name of control given in SharpDevelop or an auto-generated value)</li>
<li>-Class (this is often an autogenerated value. Could vary from an operating system to another)</li>
<li>-Value (this is typically what we see in text fields, on grid items and similar controls)</li></ul>
<br />This type of search is turned off by default. To turn it on, run the following;<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Gray;">[</span><span style="color:Teal;">UIAutomation.Preferences</span><span style="color:Gray;">]</span><span style="color:Gray;">::</span>DisableExactSearch <span style="color:Gray;">=</span> <span style="color:OrangeRed;">$false</span>;
<span style="color:Gray;">[</span><span style="color:Teal;">UIAutomation.Preferences</span><span style="color:Gray;">]</span><span style="color:Gray;">::</span>DisableWildCardSearch <span style="color:Gray;">=</span> <span style="color:OrangeRed;">$true</span>;
<span style="color:Gray;">[</span><span style="color:Teal;">UIAutomation.Preferences</span><span style="color:Gray;">]</span><span style="color:Gray;">::</span>DisableWin32Search <span style="color:Gray;">=</span> <span style="color:OrangeRed;">$true</span>;
</pre></div><br />Tags: ControlType.Window, ControlType.Button, ControlType.TabItem, ControlType.DataGrid, ControlType.DataItem, child window</div><div class="ClearBoth"></div>