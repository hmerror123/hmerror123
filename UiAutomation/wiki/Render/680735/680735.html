<div class="wikidoc">MenuOpened and MenuClosed events inform that a menu item has been clicked or activated from keyboard.<br />Their work is demostrated in the following samples:<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Green;"># an ArrayList for storing names of items clicked and for event ids</span>
<span style="color:OrangeRed;">$global:annals</span> <span style="color:Gray;">=</span> New<span style="color:Gray;">-</span>Object System.Collections.ArrayList;
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAMenuItem | Register<span style="color:Gray;">-</span>UIAMenuOpenedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.Name); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$e</span>.EventId); }
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name view | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name help | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name edit | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
<span style="color:Green;"># events are a bit slow</span>
sleep <span style="color:Gray;">-</span>Seconds 1;
<span style="color:OrangeRed;">$global:annals</span>;
</pre></div>Here we register MenuOpened events as well as menuClosed events:<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:OrangeRed;">$global:annals</span> <span style="color:Gray;">=</span> New<span style="color:Gray;">-</span>Object System.Collections.ArrayList;
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAMenuItem | Register<span style="color:Gray;">-</span>UIAMenuOpenedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:#A31515;">&quot;opened:&quot;</span>); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.Name); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$e</span>.EventId); };
Get<span style="color:Gray;">-</span>UIAMenuItem | Register<span style="color:Gray;">-</span>UIAMenuClosedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:#A31515;">&quot;closed:&quot;</span>); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.Name); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$src</span>.Cached.Name); <span style="color:OrangeRed;">$global:annals</span>.Add(<span style="color:OrangeRed;">$e</span>.EventId); };
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name view | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name help | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name edit | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand;
sleep <span style="color:Gray;">-</span>Seconds 2;
<span style="color:OrangeRed;">$global:annals</span>;
</pre></div>Note that no names of closed menu items are provided.</div><div class="ClearBoth"></div>