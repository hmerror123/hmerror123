<div class="wikidoc">This page contains recommendations of practitioners related to automated unattended runs of UIAutomation PowerShell Extensions.<br />
<h2>The general rule</h2>UIAutomation as well as other screen-related technologies of software testing and accessibility requires a user session. The session should be active, not locked (though UIAutomation shows signs of life, it gets many times slower), without screensaver.<br />We recommend you to use Windows <a href="http://technet.microsoft.com/en-us/library/gg241187(v=ws.10).aspx">autologon</a> (there is a <a href="http://technet.microsoft.com/en-us/sysinternals/bb963905.aspx">tool</a>).<br />
<h2>Normal screen vs RDP</h2><a href="http://uiautomation.codeplex.com/discussions/430391">Here</a> we discussed advantages and disadvantages of running UIAutomation via RDP connection or direct access to the host display.<br />Thanks to <a href="http://www.codeplex.com/site/users/view/georgik">georgik</a>.<br /><br />The problem is that when you are disconnecting an RDP session or even simply change the screen area, UIAutomation tests usually fail.<br />The solutions here are<br />1) to use the host screen directly or via virtualization client software <br />2) either use the seconds display.<br />Accordingly to our experience, using <a href="http://www.microsoft.com/en-us/download/details.aspx?displayLang=en&amp;id=21101">Remote Desktop Connection Manager</a> on a separate monitor may help.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=606532" alt="RDCM.jpg" title="RDCM.jpg" /><br />
<h2>VMware Client Console</h2>There is a problem with VMware Pointing Device. This driver should be uninstalled, otherwise all operations involving moving the cursor (for example, the Invoke-UIAcontrolClick uses the SetCursorPos API call to position the cursor in the geometrical center of the control) will fail.<br />
<h2>Hyper-V, XEN, etc</h2>No information right now.<br />
<h2>Running as a service</h2>Because of security vulnerabilities, Microsoft put services into the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb756986.aspx">session 0</a> since Vista RTM. Therefore, there&#39;s no way to run UIAutomation or similar tests in a service session.<br />
<h2>Manual interventions in tests</h2>Though this is nonsence as an idea (who in the healthy mind would visit the screen of a host that run automated tests?), it&#39;s possible situation during test tailoring or replaying of problemous places of the test. What can we say? Please avoid any manual intervention when you are seeing test that is running now. Some cmdlets have Win32 API calls inside that are vulnerable to the cursor postion.</div><div class="ClearBoth"></div>