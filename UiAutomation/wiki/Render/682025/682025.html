<div class="wikidoc">There is a <a href="http://softwaretestingusingpowershell.com/2012/06/04/daily-automation-hunting-down-system-tooltips/">post</a>.<br />As an additional example, we are going to report which tooltips have been opened since our sample had been run. We register TooltipOpenedEvent on the desktop object:<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:OrangeRed;">$elements</span> <span style="color:Gray;">=</span> New<span style="color:Gray;">-</span>Object System.Collections.ArrayList;
Get<span style="color:Gray;">-</span>UIADesktop | Register<span style="color:Gray;">-</span>UIAToolTipOpenedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.Name); };
</pre></div>After hovering over items in Taskbar<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=607574" alt="TooltipOpenedEvent001.jpg" title="TooltipOpenedEvent001.jpg" /><br />my output was<br />&quot;Windows PowerShell ISE&quot;<br />&quot;You are running out of disk space on Podcasts (G:).<br />Click here to see if you can free space on this drive.&quot;<br />&quot;You are running out of disk space on Local Disk (E:).<br />Click here to see if you can free space on this drive.&quot;<br />&quot;Windows PowerShell ISE&quot;<br /><br />Similarly, we can add registration for TooltipClosedEvent. In the script below, we add registration for both opening and closing tooltip events. The scripts fills the array list, allowing us to match opening and closing events by their windows&#39; handles:<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:OrangeRed;">$elements</span> <span style="color:Gray;">=</span> New<span style="color:Gray;">-</span>Object System.Collections.ArrayList;
Get<span style="color:Gray;">-</span>UIADesktop | Register<span style="color:Gray;">-</span>UIAToolTipOpenedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:#A31515;">&quot;opened:&quot;</span>); <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.Name); <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.NativeWindowhandle); }
Get<span style="color:Gray;">-</span>UIADesktop | Register<span style="color:Gray;">-</span>UIAToolTipClosedEvent <span style="color:Gray;">-</span>EventAction { <span style="color:Blue;">param</span>(<span style="color:OrangeRed;">$src</span>, <span style="color:OrangeRed;">$e</span>) <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:#A31515;">&quot;closed:&quot;</span>); <span style="color:OrangeRed;">$elements</span>.Add(<span style="color:OrangeRed;">$src</span>.Current.NativeWindowhandle); }
</pre></div><br />Tags: TooltipOpenedEvent, TooltipClosedEvent</div><div class="ClearBoth"></div>