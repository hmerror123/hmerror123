<div class="wikidoc">If a control does not support InvokePattern, it is not a big problem. We have for this purpose the Invoke-UIAcontrolClick cmdlet:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name 1 | Invoke<span style="color:Gray;">-</span>UIAControlClick;
</pre></div>Traditionally, the Invoke-UIAControlClick cmdlet supports a number of input controls:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">[</span><span style="color:Teal;">1-9</span><span style="color:Gray;">]</span> | Invoke<span style="color:Gray;">-</span>UIAControlClick;
</pre></div>This cmdlet pipelines the input to the output, if no errors raised:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">[</span><span style="color:Teal;">1-9</span><span style="color:Gray;">]</span> | Invoke<span style="color:Gray;">-</span>UIAControlClick | Read<span style="color:Gray;">-</span>UIAControlName;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598617" alt="InvokeUIAControlClick001.jpg" title="InvokeUIAControlClick001.jpg" /><br /><br />The Invoke-UIAControlClick cmdlet uses Win32 API calls (SendMessage/PostMessage, for example) working only with controls that have handles. However, the Invoke-UIAControlClick cmdlet accepts any AutomationElement, with or without a handle. How does this work? The cmdlet accepts a control, and if the input control has handle, the cmdlet hits the geometrical center of the control.<br />If a control has no handle, the cmdlet gets its parent, if there is no handle too, its respective parent unless a control with handle is found (even if it is the process&#39;s window). After that the cmdlet calculates the position that corresponds to the geometrical center of the input control and hits there. So works click on any control with the API call that works only with handles.<br /><br />The Invoke-UIAControlClick cmdlet can also be used in conditional statements, but we should remember that the SendMessage call does not return a value we could use as a result flag. Thus, the $true result means only that no network errors occured, or the system has not been shut down, etc.<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Green;"># we are not sure that click was successful</span>
<span style="color:Blue;">if</span> (Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name 1 | Invoke<span style="color:Gray;">-</span>UIAControlClick <span style="color:Gray;">-</span>PassThru:<span style="color:OrangeRed;">$false</span>) {
    <span style="color:Green;"># on probably successful click</span>
}
</pre></div>or<br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Green;"># the assume that the click was successful</span>
<span style="color:Blue;">if</span> (<span style="color:OrangeRed;">$null</span> <span style="color:Gray;">-ne</span> (Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIAButton <span style="color:Gray;">-</span>Name 1 | Invoke<span style="color:Gray;">-</span>UIAControlClick)) {
    <span style="color:Green;"># on probably successful click</span>
}
</pre></div><br />Tags: ControlType.Window, ControlType.Button, SendMessage</div><div class="ClearBoth"></div>