<div class="wikidoc">Installing of an <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb756929.aspx">uiAccess applicaiton</a> is not so easy and requires several steps to take.
<h2>Downloading the package</h2><i>Goal: obtain the irght package</i><br />First of all, download the right package. Go to the <a href="http://uiautomation.codeplex.com/">project page</a> and click the Downloads tab:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616880" alt="installing_the_module_0001.jpg" title="installing_the_module_0001.jpg" /><br />There, you need to download the package that is called as ‘UIAutomation X.Y.Z for Metro testing’ (of the latest version, of cource):<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616881" alt="installing_the_module_0002.jpg" title="installing_the_module_0002.jpg" /><br />Download the package with name like ‘UIAutomation.X.Y.Z.for.Metro.testing.zip’.
<h2>Unblocking the package (optional)</h2>You may want to unblock the package itself (in case that your operating system&#39;s settings prevent you from taking the following steps). This does not unblock the content.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616892" alt="installing_the_module_0002_1.jpg" title="installing_the_module_0002_1.jpg" /><br />The properties of an archive that was unblocked look like:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616893" alt="installing_the_module_0002_2.jpg" title="installing_the_module_0002_2.jpg" />
<h2>Unpacking</h2><i>Goal: get files</i><br />Open the package. Don’t put the content directly to the %ProgramFiles% folder! It won’t work. Security has been tightened even more (and it’s a good news for us), so that we need to do some preparations. <br />Open the package where it was saved (supposedly, in your Downloads folder):<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616882" alt="installing_the_module_0003.jpg" title="installing_the_module_0003.jpg" /><br />Unpack the zip into your user’s folder, for example, Documents. I created the folder ‘Metro’ and paste the files to there. Open properties of dlls:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616883" alt="installing_the_module_0004.jpg" title="installing_the_module_0004.jpg" /><br />Now, you need to unblock the binaries one by one:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616884" alt="installing_the_module_0005.jpg" title="installing_the_module_0005.jpg" />
<h2>Putting module files into a secure location</h2><i>Goal: put files from the package to a place where they would work unless you have changed the policy</i><br />Eventually, you can copy all the files to a folder within the ‘Program Files’ hierarchy (one of possible secure locations, called <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb756929.aspx">here</a> protected locations). If you had not unblocked the binaries, or tried to unblock in the ‘Program Files’ folder, your output in PowerShell console would look like that:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616886" alt="installing_the_module_00061.jpg" title="installing_the_module_00061.jpg" /><br />If you did all I wrote above, you output will be much cleaner:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616885" alt="installing_the_module_0007.jpg" title="installing_the_module_0007.jpg" />
<h2>Importing the certificate</h2><i>Goal: as only applications signed with recognizable certificate could work with uiAccess, you need to import the certificate that shipped with the package</i><br />With the package, you&#39;ve got a certificate. You need to install it. Alternatively, you can sign UIAutomationSpy.exe with the certificate you possibly have.<br />If you have no your own certificate, below are screenshots showing how to use the certificate from the package. Run certmgr, for example, from cmd.exe, or from the Start Screen<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616898" alt="importing_the_certificate_001.jpg" title="importing_the_certificate_001.jpg" /><br />and follow the pictures:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616899" alt="importing_the_certificate_01.jpg" title="importing_the_certificate_01.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616903" alt="importing_the_certificate_02.jpg" title="importing_the_certificate_02.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616905" alt="importing_the_certificate_03.jpg" title="importing_the_certificate_03.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616907" alt="importing_the_certificate_04.jpg" title="importing_the_certificate_04.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616909" alt="importing_the_certificate_05.jpg" title="importing_the_certificate_05.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616910" alt="importing_the_certificate_06.jpg" title="importing_the_certificate_06.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616911" alt="importing_the_certificate_07.jpg" title="importing_the_certificate_07.jpg" />
<h2>Changing the policy (as alternative to using a secure location)</h2><i>Goal: to work with module files where you&#39;d like to</i><br />After you installed the certificate and the application in the secure location (you might set the policy not to require this if you’d like to), you can run the application. If you want to change the policy, run gpedit.msc, for example, from the Start screen<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616902" alt="importing_the_certificate_002.jpg" title="importing_the_certificate_002.jpg" /><br />and set the following setting:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616904" alt="importing_the_certificate_003.jpg" title="importing_the_certificate_003.jpg" /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616906" alt="importing_the_certificate_004.jpg" title="importing_the_certificate_004.jpg" /><br />After you’ve finished, reload policies:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616908" alt="importing_the_certificate_005.jpg" title="importing_the_certificate_005.jpg" /><br />For the first test, just run the application, agree with UAC and manually run the Start screen by pressing the Win button. Now you should see something like on the picture below:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616912" alt="importing_the_certificate_09.jpg" title="importing_the_certificate_09.jpg" /><br />On the picture, UIAutomationSpy shows the code for the Mail tile. It is bordered with the red rectangle. All that I’d like to offer is to explore tiles:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=616913" alt="importing_the_certificate_10.jpg" title="importing_the_certificate_10.jpg" /><br />This is a text box, Edit in terms of UIAutomation.</div><div class="ClearBoth"></div>