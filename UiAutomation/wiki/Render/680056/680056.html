<div class="wikidoc">Let&#39;s turn calc.exe in the Programmer mode:<br /><div style="color:Black;background-color:White;"><pre>
Start<span style="color:Gray;">-</span>Process calc <span style="color:Gray;">-</span>PassThru | Get<span style="color:Gray;">-</span>UIAWindow | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name View | Invoke<span style="color:Gray;">-</span>UIAMenuItemExpand | Get<span style="color:Gray;">-</span>UIAMenuItem <span style="color:Gray;">-</span>Name Programmer | Invoke<span style="color:Gray;">-</span>UIAMenuItemClick;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598715" alt="ProgrammerMode001.jpg" title="ProgrammerMode001.jpg" />
<h2>Getting the selected item</h2>To check whether a radio button is selected or isn&#39;t:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name Dec | Get<span style="color:Gray;">-</span>UIARadioButtonSelectionItemState;
</pre></div>Though it&#39;s normal to know which of radio buttons is selected in a particular test, sometimes we need to know which one gets selected by some external reason, for example, human interaction or program&#39;s internal logic.<br />The result heavily depends on what the container of radio button is. For test, we created a simple Windows Forms application with four types of container: a group box, a tab item, a panel, and a image box:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=599425" alt="RadioButtonTest001.jpg" title="RadioButtonTest001.jpg" /><br />Of those four containers, only group box, the control natively dedicated to group elements, including radio buttons, provides SelectionPattern. As the <a href="http://msdn.microsoft.com/en-us/library/ms750574.aspx#control_mapping_clients">default control to patterns mapping</a> does not offer SelectionPattern for group box control, there is no such cmdlet: Get-UIAGroupSelection. However, for ControlType.Custom we created all types of cmdlets, so that one of them is what we can use here:<br /><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIAGroup | Get<span style="color:Gray;">-</span>UIACustomSelection;
</pre></div>There is a strange asymmetry: controls support SelectionItemPattern and, at the same time, their container does not support SelectionPattern. It&#39;s not a problem for our module, of course, let&#39;s use what we have, SelectionItemPattern, as a solution. There is a special cmdlet for that, Get-UIASelectedItem, that receives items and returns only those which are selected. We could feed it with all radio buttons the window has as well as with any amounts of radio buttons:<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=599471" alt="RadioButtonTest002.jpg" title="RadioButtonTest002.jpg" /><br /><div style="color:Black;background-color:White;"><pre>
<span style="color:Green;"># all radio buttons</span>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIARadioButton | Get<span style="color:Gray;">-</span>UIASelectedItem | Read<span style="color:Gray;">-</span>UIAControlName
<span style="color:Green;"># the result is:</span>
<span style="color:Green;"># radioButton7</span>
<span style="color:Green;"># radioButton6</span>
<span style="color:Green;"># radioButton3</span>
<span style="color:Green;"># radioButton2</span>

Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">*</span><span style="color:Gray;">[</span><span style="color:Teal;">1-2</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIASelectedItem | Read<span style="color:Gray;">-</span>UIAControlName
<span style="color:Green;"># radioButton2</span>

Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">*</span><span style="color:Gray;">[</span><span style="color:Teal;">3-4</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIASelectedItem | Read<span style="color:Gray;">-</span>UIAControlName
<span style="color:Green;"># radioButton3</span>

Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">*</span><span style="color:Gray;">[</span><span style="color:Teal;">5-6</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIASelectedItem | Read<span style="color:Gray;">-</span>UIAControlName
<span style="color:Green;"># radioButton6</span>

Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn optionbuttontest | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name <span style="color:Gray;">*</span><span style="color:Gray;">[</span><span style="color:Teal;">7-8</span><span style="color:Gray;">]</span> | Get<span style="color:Gray;">-</span>UIASelectedItem | Read<span style="color:Gray;">-</span>UIAControlName
<span style="color:Green;"># radioButton7</span>
</pre></div><h2>Setting selection</h2><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name bin | Invoke<span style="color:Gray;">-</span>UIARadioButtonSelectItem <span style="color:Gray;">-</span>ItemName bin;
</pre></div><div style="color:Black;background-color:White;"><pre>
Get<span style="color:Gray;">-</span>UIAWindow <span style="color:Gray;">-</span>pn calc | Get<span style="color:Gray;">-</span>UIARadioButton <span style="color:Gray;">-</span>Name byte | Invoke<span style="color:Gray;">-</span>UIARadioButtonSelectItem <span style="color:Gray;">-</span>ItemName byte;
</pre></div><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=UiAutomation&DownloadId=598722" alt="ProgrammerMode002.jpg" title="ProgrammerMode002.jpg" /><br />Tags: ControlType.Window, ControlType.RadioButton, AutomationElement, SelectItemPattern</div><div class="ClearBoth"></div>